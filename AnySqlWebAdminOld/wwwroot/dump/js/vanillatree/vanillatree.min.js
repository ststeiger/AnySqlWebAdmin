!function(a,b){"function"==typeof define&&define.amd?define(b):"object"==typeof module&&module.exports?module.exports=b():a.VanillaTree=b()}(this,function(){"use strict";var a=function(a,b,c,d,e,f,g,h,i,j,k,l){return l=function(a,b){return new l.i(a,b)},l.i=function(d,e){c.push.apply(this,d?d.nodeType||d==a?[d]:""+d===d?/</.test(d)?((h=b.createElement(e||"q")).innerHTML=d,h.children):(e&&l(e)[0]||b).querySelectorAll(d):/f/.test(typeof d)?/c/.test(b.readyState)?d():l(b).on("DOMContentLoaded",d):d:c)},l.i[k="prototype"]=(l.extend=function(a){for(j=arguments,h=1;h<j.length;h++)if(k=j[h])for(i in k)a[i]=k[i];return a})(l.fn=l[k]=c,{on:function(a,b){return a=a.split(d),this.map(function(c){(d[h=a[0]+(c.b$=c.b$||++e)]=d[h]||[]).push([b,a[1]]),c["add"+f](a[0],b)}),this},off:function(a,b){return a=a.split(d),k="remove"+f,this.map(function(c){if(h=(j=d[a[0]+c.b$])&&j.length)for(;i=j[--h];)b&&b!=i[0]||a[1]&&a[1]!=i[1]||(c[k](a[0],i[0]),j.splice(h,1));else!a[1]&&c[k](a[0],b)}),this},is:function(a){return!!(i=(h=this[0])&&(h.matches||h["webkit"+g]||h["moz"+g]||h["ms"+g]))&&i.call(h,a)}}),l}(window,document,[],/\.(.+)/,0,"EventListener","MatchesSelector"),b=function(b,c){return a.extend(document.createElement(b),c)},c=function(c,d){var e=this,f=e.container=a(c)[0],g=e.tree=f.appendChild(b("ul",{className:"vtree"}));e.placeholder=d&&d.placeholder,e._placeholder(),e.leafs={},g.addEventListener("click",function(b){a(b.target).is(".vtree-leaf-label")?e.select(b.target.parentNode.getAttribute("data-vtree-id")):a(b.target).is(".vtree-toggle")&&e.toggle(b.target.parentNode.getAttribute("data-vtree-id"))}),d&&d.contextmenu&&(g.addEventListener("contextmenu",function(c){var e;a(".vtree-contextmenu").forEach(function(a){a.parentNode.removeChild(a)}),a(c.target).is(".vtree-leaf-label")&&(c.preventDefault(),c.stopPropagation(),e=b("menu",{className:"vtree-contextmenu"}),a.extend(e.style,{top:c.offsetY,left:c.offsetX+18,display:"block"}),d.contextmenu.forEach(function(a){e.appendChild(b("li",{className:"vtree-contextmenu-item",innerHTML:a.label})).addEventListener("click",a.action.bind(a,c.target.parentNode.getAttribute("data-vtree-id")))}),c.target.parentNode.appendChild(e))}),document.addEventListener("click",function(b){a(".vtree-contextmenu").forEach(function(a){a.parentNode.removeChild(a)})}))};return c.prototype={constructor:c,_dispatch:function(a,b){var c;try{c=new CustomEvent("vtree-"+a,{bubbles:!0,cancelable:!0,detail:{id:b}})}catch(d){c=document.createEvent("CustomEvent"),c.initCustomEvent("vtree-"+a,!0,!0,{id:b})}return(this.getLeaf(b,!0)||this.tree).dispatchEvent(c),this},_placeholder:function(){var a;return!this.tree.children.length&&this.placeholder?this.tree.innerHTML='<li class="vtree-placeholder">'+this.placeholder+"</li>":(a=this.tree.querySelector(".vtree-placeholder"))&&this.tree.removeChild(a),this},getLeaf:function(b,c){var d=a('[data-vtree-id="'+b+'"]',this.tree)[0];if(!c&&!d)throw Error('No VanillaTree leaf with id "'+b+'"');return d},getChildList:function(c){var d,e;return c?(e=this.getLeaf(c),(d=a("ul",e)[0])||(d=e.appendChild(b("ul",{className:"vtree-subtree"})))):d=this.tree,d},add:function(a){var c,d=b("li",{className:"vtree-leaf"}),e=this.getChildList(a.parent);return d.setAttribute("data-vtree-id",c=a.id||Math.random()),d.appendChild(b("span",{className:"vtree-toggle"})),d.appendChild(b("a",{className:"vtree-leaf-label",innerHTML:a.label})),e.appendChild(d),e!==this.tree&&e.parentNode.classList.add("vtree-has-children"),this.leafs[c]=a,a.opened||this.close(c),a.selected&&this.select(c),this._placeholder()._dispatch("add",c)},move:function(a,b){var c=this.getLeaf(a),d=c.parentNode,e=this.getLeaf(b,!0);return e&&e.classList.add("vtree-has-children"),this.getChildList(b).appendChild(c),d.parentNode.classList.toggle("vtree-has-children",!!d.children.length),this._dispatch("move",a)},remove:function(a){var b=this.getLeaf(a),c=b.parentNode;return c.removeChild(b),c.parentNode.classList.toggle("vtree-has-children",!!c.children.length),this._placeholder()._dispatch("remove",a)},open:function(a){return this.getLeaf(a).classList.remove("closed"),this._dispatch("open",a)},close:function(a){return this.getLeaf(a).classList.add("closed"),this._dispatch("close",a)},toggle:function(a){return this[this.getLeaf(a).classList.contains("closed")?"open":"close"](a)},select:function(b){var c=this.getLeaf(b);return c.classList.contains("vtree-selected")||(a("li.vtree-leaf",this.tree).forEach(function(a){a.classList.remove("vtree-selected")}),c.classList.add("vtree-selected"),this._dispatch("select",b)),this}},c});
